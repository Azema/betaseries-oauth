!function(t,e){"object"==typeof exports?module.exports=e(t):"function"==typeof define&&define.amd?define([],e):t.lazyLoad=e(t)}("undefined"!=typeof global?global:this.window||this.global,function(e){"use strict";"function"==typeof define&&define.amd&&(e=window);const s={src:"data-src",srcset:"data-srcset",selector:".lazyload",root:null,rootMargin:"0px",threshold:0};function i(t,e){this.domain=window.location.hostname.substring(window.location.hostname.indexOf(".")+1),this.regDomain=new RegExp(this.domain,"i"),this.settings=Object.assign({},s,e||{}),this.images=t||document.querySelectorAll(this.settings.selector),this.observer=null,this.init()}if(i.prototype={init:function(){if(e.IntersectionObserver){let s=this;var t={root:this.settings.root,rootMargin:this.settings.rootMargin,threshold:[this.settings.threshold]};this.observer=new IntersectionObserver(function(t){Array.prototype.forEach.call(t,function(e){if(e.isIntersecting)if(s.observer.unobserve(e.target),"img"===e.target.tagName.toLowerCase())s.settings.attribute?s.preloadImg(e.target,s.settings.attribute):e.target.getAttribute(s.settings.src)?s.preloadImg(e.target,"src"):e.target.getAttribute(s.settings.srcset)&&s.preloadImg(e.target,"srcset");else{let t;s.settings.attribute?t=e.target.getAttribute(s.settings.attribute):e.target.getAttribute(s.settings.src)&&(t=e.target.getAttribute(s.settings.src)),t&&(e.target.style.backgroundImage=`url(${t})`)}})},t),Array.prototype.forEach.call(this.images,function(t){t.classList.contains("js-lazy-image-handled")||s.observer.observe(t)})}else this.loadImages()},fetchImg:function(i){return new Promise((t,e)=>{const s=new Image;this.regDomain.test(i)||(s.crossOrigin="anonymous"),s.src=i,s.onload=t,s.onerror=e})},applyImg:function(t,e,s){t.classList.add("js-lazy-image-handled"),this.regDomain.test(e)||(t.crossorigin="anonymous"),t[s]=e,t.classList.add("fade-in")},preloadImg:function(e,s){const i=e.getAttribute(s);if(i&&0<i.length){const t=this.fetchImg(i);t.then(()=>this.applyImg(e,i,s.replace("data-",""))),this.settings.onerror&&"function"==typeof this.settings.onerror?t.catch(t=>this.settings.onerror(t,e,i,s.replace("data-",""))):t.catch(()=>{})}},loadAndDestroy:function(){this.settings&&(this.loadImages(),this.destroy())},loadImages:function(){if(this.settings){let i=this;Array.prototype.forEach.call(this.images,function(t){i.observer.unobserve(t);var e=t.getAttribute(i.settings.src),s=t.getAttribute(i.settings.srcset);"img"===t.tagName.toLowerCase()?i.settings.attribute?i.preloadImg(t,i.settings.attribute):e?i.preloadImg(t,"src"):s&&i.preloadImg(t,"srcset"):t.style.backgroundImage=`url(${e})`})}},destroy:function(){this.settings&&(this.observer.disconnect(),this.settings=null)}},e.lazyLoad=function(t,e){return new i(t,e)},e.jQuery){const r=e.jQuery;r.fn.lazyload=function(t){return(t=t||{}).attribute=t.attribute||"data-src",new i(r.makeArray(this),t),this}}return i});